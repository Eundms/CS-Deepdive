# 네트워크 계층 (3계층)

## 인터넷 프로토콜 (IP): IPv4, IPv6
### 서브넷
- **정의**: IP 주소 클래스 할당의 한계점을 극복하기 위해 네트워크를 더 작은 네트워크 영역으로 분할.
- **서브넷 마스크**: 네트워크 부분과 호스트 부분을 분리.
- **CIDR (Classless Inter-Domain Routing)**:
  - A.B.C.D/N 형식으로 표기.
  - **예시**: `192.168.10.70/26`
    - 서브넷 마스크: `255.255.255.192`
    - 네트워크 ID: `192.168.10.64`
    - 브로드캐스트 주소: `192.168.10.127`
    - 호스트 수: `(256 - 192) - 2 = 62`

### 호스트와 서브넷의 주소 인식 방법
1. **IP 주소 블록 획득**: 기관이 ISP로부터 서브넷에 사용 가능한 IP 주소 블록을 요청.
2. **IP 주소 할당**: 개별 호스트와 라우터 인터페이스에 IP 주소를 할당.
   - **DHCP (동적 호스트 구성 프로토콜)**: IP 주소를 자동으로 배포하고 관리.

#### 네트워크 주소 변환 (NAT)
- **작동 방식**: 내부 네트워크의 IP 주소를 공인 IP 주소로 변환하여 인터넷 통신.
- **NAT 테이블**:
  - 내부 IP + 포트 번호 ↔ 공인 IP + 포트 번호
- **장점**:
  - 공인 IP 주소 절약.
  - 내부 네트워크 보호.

---

## IPv6와 IPv4의 차이
- **주소 길이**:
  - IPv4: 32비트 (약 43억 개 주소).
  - IPv6: 128비트 (엄청난 주소 공간).
- **애니캐스트**: 패킷을 가장 가까운 하나의 호스트로 전달.
- **헤더 간소화**: IPv6는 헤더 필드를 간소화하여 라우팅 성능 향상.
- **IPsec**: IPv6는 기본적으로 보안 프로토콜(IPsec)을 지원.

### IPv4 -> IPv6 전환 방식

#### 1. 터널링 (Tunneling)
- **정의**: IPv6 패킷을 IPv4 네트워크에서 캡슐화하여 전송하는 방법.
- **작동 방식**:
  - IPv6 헤더와 데이터를 IPv4 패킷 내부에 캡슐화.
  - IPv4 네트워크를 통해 전송된 후, 수신 측에서 캡슐화가 제거되어 IPv6 데이터가 전달됨.
- **특징**:
  - IPv4 네트워크를 활용하여 IPv6 데이터를 전송 가능.
  - 전환 초기 단계에서 IPv6 호스트 간의 통신을 지원.
- **장점**:
  - 기존 IPv4 네트워크와 호환 가능.
  - 별도의 새로운 네트워크 장비 없이도 사용 가능.
- **단점**:
  - 캡슐화로 인해 헤더 오버헤드 증가.
  - 라우팅 경로 최적화 어려움.
- **터널링 방식 예시**:
  - **6to4**: IPv6 주소를 기반으로 자동 터널링.
  - **ISATAP (Intra-Site Automatic Tunnel Addressing Protocol)**: 단일 사이트 내 IPv6 전송 지원.
  - **Teredo**: NAT(Network Address Translation)를 통한 IPv6 터널링.

---

#### 2. 듀얼 스택 (Dual Stack)
- **정의**: 하나의 네트워크 장치(라우터, 호스트 등)가 IPv4와 IPv6를 동시에 지원하도록 설정.
- **작동 방식**:
  - 네트워크 장비와 호스트는 IPv4와 IPv6 주소를 모두 할당받아 통신.
  - 통신 대상이 IPv4를 사용하면 IPv4를, IPv6를 사용하면 IPv6를 통해 데이터 전송.
- **특징**:
  - 네트워크 장비와 호스트가 양쪽 프로토콜을 모두 지원.
  - 전환 과정에서 IPv4와 IPv6가 공존하는 환경 제공.
- **장점**:
  - 프로토콜 간 변환 없이 기존 IPv4 및 IPv6 장치와 직접 통신 가능.
  - 사용자 및 애플리케이션에는 전환이 투명하게 보임.
- **단점**:
  - 장비와 네트워크 관리 복잡성 증가.
  - IPv4와 IPv6 주소를 모두 관리해야 하는 부담.
- **활용 예시**:
  - 현재 대부분의 인터넷 서비스 제공업체(ISP)와 대규모 조직에서 사용.

---

### 터널링과 듀얼 스택 비교

| **특징**           | **터널링**                           | **듀얼 스택**                      |
|--------------------|------------------------------------|------------------------------------|
| **작동 방식**       | IPv6 데이터를 IPv4 네트워크에서 캡슐화 전송 | IPv4와 IPv6를 모두 동시에 지원        |
| **장점**           | 기존 IPv4 네트워크 활용 가능            | 프로토콜 변환 없이 직접 통신 가능       |
| **단점**           | 헤더 오버헤드, 경로 최적화 문제         | 관리 복잡성 증가, 이중 주소 관리 필요   |
| **적용 시점**       | IPv6 도입 초기, IPv4 네트워크 활용 시    | IPv4와 IPv6 공존 환경에서 점진적 전환 |

---

## SDN (Software Defined Networking)

### 1. SDN의 개념
- **정의**: 네트워크의 제어 평면(Control Plane)과 데이터 평면(Data Plane)을 분리하여 네트워크를 프로그래밍 방식으로 제어하는 기술.
- **구성 요소**:
  1. **애플리케이션 계층 (Application Layer)**:
     - 네트워크 제어를 위한 사용자 애플리케이션과 인터페이스.
     - 예: 트래픽 관리, 보안 정책, 부하 분산.
  2. **제어 계층 (Control Layer)**:
     - 네트워크 장치의 동작을 중앙에서 관리.
     - SDN 컨트롤러가 위치하여 네트워크의 논리적 동작을 제어.
  3. **데이터 계층 (Data Layer)**:
     - 패킷을 실제로 전송하고 처리하는 네트워크 장치.
     - 예: 스위치, 라우터.

---

### 2. SDN의 특징
- **중앙 집중 관리**:
  - 네트워크 전체를 중앙 컨트롤러를 통해 제어.
  - 네트워크 설정 및 변경 사항을 빠르고 쉽게 반영.
- **프로그래머블 네트워크**:
  - 네트워크를 소프트웨어처럼 프로그래밍 가능.
  - 새로운 네트워크 기능을 구현하기 쉬움.
- **유연성 및 확장성**:
  - 네트워크 리소스를 동적으로 할당하고 구성 가능.
  - 대규모 네트워크에서도 효율적인 관리 가능.
- **비용 효율성**:
  - 범용 하드웨어 사용이 가능해 비용 절감.
  - 기존 네트워크 환경의 제약 없이 새로운 기술 도입 가능.

---

### 3. SDN의 구성
- **SDN 컨트롤러**:
  - 네트워크의 '뇌' 역할.
  - 데이터 평면 장치와 애플리케이션 간의 중계 역할 수행.
  - 예: OpenDaylight, ONOS.
- **프로토콜**:
  - SDN 컨트롤러와 데이터 평면 간의 통신을 위한 프로토콜.
  - 예: OpenFlow.
- **데이터 평면**:
  - 패킷을 실제로 전송하는 네트워크 장치.
  - SDN 컨트롤러의 명령에 따라 동작.

---

### 4. SDN의 장점
1. **네트워크 가시성 향상**:
   - 네트워크 흐름을 실시간으로 확인 가능.
2. **자동화 및 간소화**:
   - 수작업 설정 대신 자동화된 프로세스로 관리.
3. **보안 강화**:
   - 중앙 집중 관리로 인해 네트워크 보안 정책의 일관성 보장.
4. **효율적인 자원 활용**:
   - 트래픽을 동적으로 최적화.

---

### 5. SDN의 단점
1. **중앙 집중 관리의 의존성**:
   - 컨트롤러 장애 시 전체 네트워크 영향 가능성.
2. **초기 구축 비용**:
   - 기존 네트워크를 SDN 환경으로 전환하는 데 비용이 발생.
3. **학습 곡선**:
   - 기존 네트워크 관리와는 다른 새로운 기술로 인해 학습 필요.

---

### 6. 활용 사례
- **데이터센터**:
  - 대규모 데이터센터의 네트워크를 효율적으로 관리.
  - 가상머신(VM)의 동적 이동 지원.
- **클라우드 컴퓨팅**:
  - 클라우드 서비스의 확장성 및 유연성을 지원.
- **네트워크 보안**:
  - 침입 탐지 및 방어 시스템과 통합.
  - 중앙에서 보안 정책을 관리 및 적용.


---

## 네트워크 제어 평면

### 라우팅 알고리즘
#### 중앙 집중형 라우팅 vs 분산 라우팅
- **중앙 집중형**:
  - 네트워크 전체 정보를 하나의 노드가 수집하여 라우팅 결정.
  - 예: SDN 컨트롤러.
- **분산 라우팅**:
  - 각 노드가 이웃 노드와 정보를 교환하며 라우팅 결정.
  - 예: RIP, OSPF.

#### 정적 라우팅 vs 동적 라우팅
- **정적 라우팅**:
  - 경로가 미리 설정되고 변경되지 않음.
  - 관리자가 직접 설정.
- **동적 라우팅**:
  - 네트워크 상태 변화에 따라 경로가 자동으로 업데이트.
  - 예: OSPF, BGP.

## OSPF (Open Shortest Path First)  
### 1. 개요  
- 링크 상태 라우팅 프로토콜로, 내부 게이트웨이 프로토콜(IGP)의 일종.  
- 네트워크 내에서 가장 짧은 경로를 찾기 위해 **다익스트라 알고리즘**을 사용.  
- 대규모 네트워크 환경에서 효율적인 라우팅 가능.  
- 주로 자율 시스템(AS) 내부에서 사용됨.  

---

### 2. OSPF의 특징  
1. **링크 상태 광고(LSA)**  
   - 네트워크의 상태 정보를 담은 메시지로, 네트워크 전체에 플러딩됨.  
2. **라우팅 영역**  
   - 네트워크를 효율적으로 관리하기 위해 **영역(Area)**으로 분리.  
   - 예: 백본 영역(Area 0)은 다른 영역과의 통신을 담당.  
3. **다익스트라 알고리즘**  
   - 링크 상태 데이터베이스(LSDB)를 기반으로 최단 경로를 계산.  
4. **CIDR 및 VLSM 지원**  
   - 비클래스 네트워크(CIDR)와 가변 길이 서브넷 마스크(VLSM)를 지원.  

---

### 3. OSPF의 동작 과정  
1. **Neighbor Discovery**: OSPF 인접 라우터와 연결을 설정.  
2. **Link State Advertisement (LSA)**: 네트워크 상태 정보를 브로드캐스트.  
3. **Shortest Path Tree (SPT) 계산**: 다익스트라 알고리즘으로 최단 경로 계산.  
4. **Routing Table 생성**: SPT를 기반으로 라우팅 테이블 생성.  

---

### 4. OSPF의 장점  
- 빠른 **수렴 속도**.  
- **확장성**: 대규모 네트워크에서도 영역 분리로 효율적 관리.  
- **로드 밸런싱**: 동일한 비용의 다중 경로를 지원.  
- 실시간 네트워크 상태 반영.  

---

### 5. OSPF의 단점  
- 설정 및 관리가 복잡.  
- 작은 네트워크에서는 다소 과도한 기능.  

---

## BGP (Border Gateway Protocol)  
### 1. 개요  
- 경로 벡터 라우팅 프로토콜로, 외부 게이트웨이 프로토콜(EGP)의 일종.  
- 주로 자율 시스템(AS) 간의 라우팅에 사용됨.  
- 인터넷과 같은 대규모 네트워크의 기본 라우팅 프로토콜.  

---

### 2. BGP의 특징  
1. **AS 간의 라우팅**  
   - AS 경로 정보를 바탕으로 최적의 경로를 결정.  
   - 라우팅 정보에 AS 번호를 포함하여 경로 루프 방지.  
2. **정책 기반 라우팅**  
   - 네트워크 운영자의 정책에 따라 경로를 선택.  
3. **Path Vector**  
   - 거리 벡터 방식에 AS 경로 정보를 추가한 형태.  
4. **CIDR 지원**  
   - 효율적인 IP 주소 할당을 위해 CIDR 지원.  

---

### 3. BGP의 동작 과정  
1. **Neighbor Establishment**: BGP 인접 라우터 간의 연결 설정.  
2. **Route Advertisement**: 경로 정보를 교환.  
3. **Path Selection**: 정책에 따라 최적의 경로 선택.  
4. **Route Propagation**: 선택된 경로를 다른 AS에 전달.  

---

### 4. BGP의 장점  
- **확장성**: 대규모 네트워크에서 효율적 작동.  
- **정책 기반 제어**: 운영자의 라우팅 정책을 유연하게 반영.  
- **경로 안정성**: 경로 루프를 방지하고 안정적으로 동작.  

---

### 5. BGP의 단점  
- **수렴 속도 느림**: OSPF에 비해 라우팅 정보 반영이 느림.  
- **복잡한 설정**: 관리자가 세부적인 정책을 수동으로 설정해야 함.  

---

### OSPF와 BGP의 비교  

| **항목**               | **OSPF**                           | **BGP**                           |
|------------------------|-------------------------------------|-------------------------------------|
| **용도**               | AS 내부 라우팅                     | AS 간 라우팅                       |
| **라우팅 방식**         | 링크 상태                          | 경로 벡터                          |
| **알고리즘**           | 다익스트라 알고리즘                | 정책 기반                          |
| **수렴 속도**          | 빠름                               | 느림                               |
| **확장성**             | 대규모 네트워크에서는 제한적        | 매우 뛰어남                        |
| **사용 사례**          | 기업 내부 네트워크, LAN            | 인터넷 및 ISP 네트워크             |


---

## ICMP (Internet Control Message Protocol)
- **역할**: 네트워크 오류와 상태 정보를 전달.
- **주요 메시지**:
  - Ping: 연결 상태 확인.
  - Destination Unreachable: 목적지에 도달할 수 없음.
  - Time Exceeded: TTL(Time to Live) 초과.

---

## 네트워크 관리와 SNMP (Simple Network Management Protocol)
- **SNMP 정의**:
  - 네트워크 장치를 관리하고 모니터링하기 위한 프로토콜.
- **구성 요소**:
  - **Manager**: 데이터를 수집하고 제어.
  - **Agent**: 장치에서 데이터를 제공.
  - **MIB**: 관리 정보 베이스(네트워크 장치 정보 데이터베이스).
- **활용**:
  - 트래픽 분석, 장애 탐지, 장치 상태 모니터링.
